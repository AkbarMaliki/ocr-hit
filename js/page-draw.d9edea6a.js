"use strict";(self["webpackChunknew"]=self["webpackChunknew"]||[]).push([[990],{5136:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[t.modal?e("div",{staticStyle:{position:"fixed",width:"100vw",height:"100vh",left:"0",top:"0","z-index":"100",background:"black",opacity:"0.6"}}):t._e(),t.modal?e("div",{staticStyle:{position:"fixed",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)","z-index":"105","min-width":"50vw"}},[e("div",{staticClass:"rounded-lg shadow p-3 bg-white animate__animated animate__bounceIn"},[e("button",{staticClass:"btn btn-sm btn-dark float-right",attrs:{type:"button"},on:{click:function(e){t.modal=!1}}},[t._v("x")]),e("div",{staticClass:"p-3"},[e("h4",[t._v("Form Input")]),e("hr"),e("form",{attrs:{action:""},on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("div",{staticClass:"sm-form"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.vdata["field"],expression:"vdata['field']"}],staticClass:"form-control p-2 rounded-lg shadow",attrs:{type:"text",id:"field",name:"field",placeholder:"field"},domProps:{value:t.vdata["field"]},on:{input:function(e){e.target.composing||t.$set(t.vdata,"field",e.target.value)}}})]),e("hr"),e("button",{staticClass:"btn btn-sm btn-success",attrs:{type:"submit"}},[t._v("Simpan")])])])])]):t._e(),e("br"),e("br"),e("button",{staticClass:"btn btn-sm btn-dark ml-2",on:{click:t.toggleDraw}},[e("i",{staticClass:"fa fa-pencil-square-o",attrs:{"aria-hidden":"true"}})]),e("button",{staticClass:"btn btn-sm btn-danger ml-2",on:{click:t.toggleDelete}},[e("i",{staticClass:"fa fa-eraser",attrs:{"aria-hidden":"true"}})]),e("button",{staticClass:"btn btn-sm btn-success ml-2",on:{click:t.saveBox}},[e("i",{staticClass:"fa fa-floppy-o",attrs:{"aria-hidden":"true"}})]),e("br"),e("br"),t.drawState?e("div",[t._v("Drawing Active...")]):t._e(),t.deleteState?e("div",[t._v("Delete Active...")]):t._e(),e("div",{ref:"imageContainer",staticClass:"image-container",staticStyle:{position:"relative",overflow:"auto",height:"500px"},on:{mousedown:function(e){return e.preventDefault(),t.mousedown.apply(null,arguments)},mousemove:t.mousemove,mouseup:t.mouseup}},[e("img",{attrs:{src:t.imageUrl,alt:"",id:"original"}}),t._l(t.rectangles,(function(s,a){return e("div",{key:a,staticClass:"rectangle",style:t.getRectangleStyles(s),on:{click:function(e){return e.stopPropagation(),t.deleteRectangle(a)}}})}))],2),e("div",{staticClass:"p-2 row"},[e("div",{staticClass:"col-12"},[e("p",[t._v("Table : "+t._s(t.item.table))]),e("hr")]),t._l(t.rectangles,(function(s,a){return e("div",{key:a+"rectangles",staticClass:"col-3"},[e("div",{staticClass:"p-2 shadow rounded-sm"},[e("p",{staticClass:"m-0 p-0 text-xs"},[t._v("Field : "+t._s(s.field))]),e("p",{staticClass:"m-0 p-0 text-xs"},[t._v("height : "+t._s(s.height))]),e("p",{staticClass:"m-0 p-0 text-xs"},[t._v("width : "+t._s(s.width))]),e("p",{staticClass:"m-0 p-0 text-xs"},[t._v("x : "+t._s(s.x))]),e("p",{staticClass:"m-0 p-0 text-xs"},[t._v("y : "+t._s(s.y))])])])}))],2),e("hr")])},i=[],o=(s(7658),{data(){return{rectangles:[],resizeBox:[],drawing:!1,start:{x:0,y:0},imageUrl:"https://hit-ocr.online/uploaded/image.jpg",drawState:!1,deleteState:!1,modal:!1,undoStack:[],redoStack:[],item:{},vdata:{}}},methods:{async submitForm(){let t=this;const e=firebase.doc(firebase.firestore,"ocr-layouts",this.$route.query.id);this.rectangles[this.rectangles.length-1]["field"]=this.vdata.field,firebase.updateDoc(e,{boxes:this.rectangles}).then((()=>{t.modal=!1,t.vdata={}})).catch((t=>{console.error("Error updating document:",t)}))},cropimage(){const t=document.getElementById("original"),e=50,s=50,a=100,i=100,o=document.createElement("canvas"),r=o.getContext("2d");o.width=a,o.height=i,r.drawImage(t,-e,-s);const n=o.toDataURL(),l=[n];console.log("Cropped Image List:",l)},saveBox(){const t=firebase.doc(firebase.firestore,"ocr-layouts",this.$route.query.id);firebase.updateDoc(t,{boxes:this.rectangles}).then((()=>{})).catch((t=>{console.error("Error updating document:",t)}))},async getData(){let t=this;const e=firebase.doc(firebase.firestore,"ocr-layouts",t.$route.query.id);firebase.getDoc(e).then((e=>{if(e.exists()){let s=e.data();t.item=s,s.boxes&&(t.rectangles=s.boxes),t.imageUrl="https://hit-ocr.online/uploaded/"+s.filename,console.log("Document data:",e.data())}else console.log("Document does not exist")})).catch((t=>{console.error("Error getting document:",t)}))},resizeBoxes(){function t(t,e,s,a,i){const o=a/e,r=i/s,n=t.map((t=>({x:Math.round(t.x*o),y:Math.round(t.y*r),width:Math.round(t.width*o),height:Math.round(t.height*r)})));return n}const e=this.rectangles,s=that.item.width,a=that.item.height,i=393,o=644;t(e,s,a,i,o)},mousedown(t){if(!this.deleteState&&this.drawState){this.drawing=!0;const{offsetX:e,offsetY:s}=t;this.start={x:e,y:s},this.rectangles.push({...this.start,width:0,height:0})}},mousemove(t){if(!this.deleteState&&this.drawState&&this.drawing){const{offsetX:e,offsetY:s}=t,{x:a,y:i}=this.start,o=this.rectangles[this.rectangles.length-1];o.width=e-a,o.height=s-i,this.saveToLocalStorage()}},mouseup(){this.drawing&&(console.log("cek",this.rectangles[this.rectangles.length-1]),0!=this.rectangles[this.rectangles.length-1]["width"]&&0!=this.rectangles[this.rectangles.length-1]["height"]&&(this.modal=!0)),this.rectangles=this.rectangles.filter((t=>0!=t.width&&0!=t.height)),this.drawState&&(this.drawing=!1)},deleteRectangle(t){this.deleteState&&(this.rectangles.splice(t,1),this.saveToLocalStorage(),this.saveBox())},getRectangleStyles({x:t,y:e,width:s,height:a}){return{position:"absolute",left:`${t}px`,top:`${e}px`,width:`${s}px`,height:`${a}px`,border:"1px solid red"}},undo(){this.rectangles.length>0&&(this.redoStack.push(this.rectangles.pop()),this.saveToLocalStorage(),this.saveBox())},redo(){this.redoStack.length>0&&(this.rectangles.push(this.redoStack.pop()),this.saveToLocalStorage(),this.saveBox())},toggleDraw(){this.drawState=!this.drawState,this.deleteState=!1},toggleDelete(){this.deleteState=!this.deleteState,this.drawState=!1},saveToLocalStorage(){}},mounted(){this.getData(),document.addEventListener("keydown",(t=>{t.ctrlKey&&"z"===t.key?this.undo():t.ctrlKey&&"y"===t.key&&this.redo()}))},created(){localStorage.getItem("rectangles")&&(this.rectangles=JSON.parse(localStorage.getItem("rectangles")))}}),r=o,n=s(1001),l=(0,n.Z)(r,a,i,!1,null,"6d262464",null),c=l.exports}}]);
//# sourceMappingURL=page-draw.d9edea6a.js.map