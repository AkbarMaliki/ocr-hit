{"version":3,"file":"js/page-draw.d9edea6a.js","mappings":"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","sources":["webpack://new/./src/pages/draw.vue","webpack://new/src/pages/draw.vue","webpack://new/./src/pages/draw.vue?0e23","webpack://new/./src/pages/draw.vue?6f9d"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"container\"},[(_vm.modal)?_c('div',{staticStyle:{\"position\":\"fixed\",\"width\":\"100vw\",\"height\":\"100vh\",\"left\":\"0\",\"top\":\"0\",\"z-index\":\"100\",\"background\":\"black\",\"opacity\":\"0.6\"}}):_vm._e(),(_vm.modal)?_c('div',{staticStyle:{\"position\":\"fixed\",\"top\":\"50%\",\"left\":\"50%\",\"transform\":\"translateX(-50%) translateY(-50%)\",\"z-index\":\"105\",\"min-width\":\"50vw\"}},[_c('div',{staticClass:\"rounded-lg shadow p-3 bg-white animate__animated animate__bounceIn\"},[_c('button',{staticClass:\"btn btn-sm btn-dark float-right\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){_vm.modal=false}}},[_vm._v(\"x\")]),_c('div',{staticClass:\"p-3\"},[_c('h4',[_vm._v(\"Form Input\")]),_c('hr'),_c('form',{attrs:{\"action\":\"\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.submitForm.apply(null, arguments)}}},[_c('div',{staticClass:\"sm-form\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.vdata['field']),expression:\"vdata['field']\"}],staticClass:\"form-control p-2 rounded-lg shadow\",attrs:{\"type\":\"text\",\"id\":\"field\",\"name\":\"field\",\"placeholder\":\"field\"},domProps:{\"value\":(_vm.vdata['field'])},on:{\"input\":function($event){if($event.target.composing)return;_vm.$set(_vm.vdata, 'field', $event.target.value)}}})]),_c('hr'),_c('button',{staticClass:\"btn btn-sm btn-success\",attrs:{\"type\":\"submit\"}},[_vm._v(\"Simpan\")])])])])]):_vm._e(),_c('br'),_c('br'),_c('button',{staticClass:\"btn btn-sm btn-dark ml-2\",on:{\"click\":_vm.toggleDraw}},[_c('i',{staticClass:\"fa fa-pencil-square-o\",attrs:{\"aria-hidden\":\"true\"}})]),_c('button',{staticClass:\"btn btn-sm btn-danger ml-2\",on:{\"click\":_vm.toggleDelete}},[_c('i',{staticClass:\"fa fa-eraser\",attrs:{\"aria-hidden\":\"true\"}})]),_c('button',{staticClass:\"btn btn-sm btn-success ml-2\",on:{\"click\":_vm.saveBox}},[_c('i',{staticClass:\"fa fa-floppy-o\",attrs:{\"aria-hidden\":\"true\"}})]),_c('br'),_c('br'),(_vm.drawState)?_c('div',[_vm._v(\"Drawing Active...\")]):_vm._e(),(_vm.deleteState)?_c('div',[_vm._v(\"Delete Active...\")]):_vm._e(),_c('div',{ref:\"imageContainer\",staticClass:\"image-container\",staticStyle:{\"position\":\"relative\",\"overflow\":\"auto\",\"height\":\"500px\"},on:{\"mousedown\":function($event){$event.preventDefault();return _vm.mousedown.apply(null, arguments)},\"mousemove\":_vm.mousemove,\"mouseup\":_vm.mouseup}},[_c('img',{attrs:{\"src\":_vm.imageUrl,\"alt\":\"\",\"id\":\"original\"}}),_vm._l((_vm.rectangles),function(rect,index){return _c('div',{key:index,staticClass:\"rectangle\",style:(_vm.getRectangleStyles(rect)),on:{\"click\":function($event){$event.stopPropagation();return _vm.deleteRectangle(index)}}})})],2),_c('div',{staticClass:\"p-2 row\"},[_c('div',{staticClass:\"col-12\"},[_c('p',[_vm._v(\"Table : \"+_vm._s(_vm.item.table))]),_c('hr')]),_vm._l((_vm.rectangles),function(item,index){return _c('div',{key:index+'rectangles',staticClass:\"col-3\"},[_c('div',{staticClass:\"p-2 shadow rounded-sm\"},[_c('p',{staticClass:\"m-0 p-0 text-xs\"},[_vm._v(\"Field : \"+_vm._s(item.field))]),_c('p',{staticClass:\"m-0 p-0 text-xs\"},[_vm._v(\"height : \"+_vm._s(item.height))]),_c('p',{staticClass:\"m-0 p-0 text-xs\"},[_vm._v(\"width : \"+_vm._s(item.width))]),_c('p',{staticClass:\"m-0 p-0 text-xs\"},[_vm._v(\"x : \"+_vm._s(item.x))]),_c('p',{staticClass:\"m-0 p-0 text-xs\"},[_vm._v(\"y : \"+_vm._s(item.y))])])])})],2),_c('hr')])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"container\">\r\n    <!-- MODAL -->\r\n    <div v-if=\"modal\"  style=\"position:fixed;width:100vw;height:100vh;left:0;top:0;z-index:100;background:black;opacity:0.6\"></div>\r\n    <div v-if=\"modal\" style=\"position: fixed;top: 50%;left: 50%;transform: translateX(-50%) translateY(-50%);z-index:105;min-width:50vw;\">\r\n        <div class=\"rounded-lg shadow p-3 bg-white animate__animated animate__bounceIn\">\r\n          <button type=\"button\" @click=\"modal=false\" class=\"btn btn-sm btn-dark  float-right\">x</button>\r\n            <div class=\"p-3 \">\r\n              <h4>Form Input</h4>\r\n              <hr>\r\n              <form action=\"\" @submit.prevent=\"submitForm\">\r\n                <div class=\"sm-form \">\r\n                    <input type=\"text\" id=\"field\" name=\"field\" class=\"form-control p-2 rounded-lg shadow\" placeholder=\"field\" v-model=\"vdata['field']\" >\r\n                </div>\r\n                <hr>\r\n                <button type=\"submit\" class=\"btn btn-sm btn-success\">Simpan</button>\r\n              </form>\r\n            </div>      \r\n        </div>\r\n    </div>\r\n        <!-- MODAL -->\r\n    <br>\r\n    <br>\r\n    <button @click=\"toggleDraw\" class=\"btn btn-sm btn-dark ml-2\"><i class=\"fa fa-pencil-square-o\" aria-hidden=\"true\"></i></button>\r\n    <button @click=\"toggleDelete\"  class=\"btn btn-sm btn-danger ml-2\"><i class=\"fa fa-eraser\" aria-hidden=\"true\"></i></button>\r\n    <button @click=\"saveBox\" class=\"btn btn-sm btn-success ml-2\"><i class=\"fa fa-floppy-o\" aria-hidden=\"true\"></i></button>\r\n    <!-- <button class=\"btn btn-dark btn-sm ml-2\" @click=\"cropimage\"><i class=\"fa fa-scissors\" aria-hidden=\"true\"></i></button> -->\r\n    <br>\r\n    <br>\r\n    <!-- <button @click=\"resizeBoxes\">convert Boxes</button> -->\r\n    <div v-if=\"drawState\">Drawing Active...</div>\r\n    <div v-if=\"deleteState\">Delete Active...</div>\r\n    <div class=\"image-container\" \r\n      @mousedown.prevent=\"mousedown\"\r\n      @mousemove=\"mousemove\"\r\n      @mouseup=\"mouseup\"\r\n      ref=\"imageContainer\"\r\n      style=\"position: relative; overflow: auto; height: 500px;\">\r\n      <img :src=\"imageUrl\" alt=\"\" id=\"original\">\r\n      <div\r\n        v-for=\"(rect, index) in rectangles\"\r\n        :key=\"index\"\r\n        :style=\"getRectangleStyles(rect)\"\r\n        class=\"rectangle\"\r\n        @click.stop=\"deleteRectangle(index)\"\r\n      ></div>\r\n    </div>\r\n    <div class=\"p-2 row\">\r\n      <div class=\"col-12\">\r\n        <p>Table : {{item.table}}</p>\r\n        <hr>\r\n      </div>\r\n      <div v-for=\"(item, index) in rectangles\" :key=\"index+'rectangles'\" class=\"col-3\">\r\n        <div class=\"p-2 shadow rounded-sm\">\r\n          <p class=\"m-0 p-0 text-xs\">Field : {{item.field}}</p>\r\n          <p class=\"m-0 p-0 text-xs\">height : {{item.height}}</p>\r\n          <p class=\"m-0 p-0 text-xs\">width : {{item.width}}</p>\r\n          <p class=\"m-0 p-0 text-xs\">x : {{item.x}}</p>\r\n          <p class=\"m-0 p-0 text-xs\">y : {{item.y}}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <hr>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    data() {\r\n        return {\r\n          rectangles: [],\r\n          resizeBox:[],\r\n          drawing: false,\r\n          start: { x: 0, y: 0 },\r\n          imageUrl: 'https://hit-ocr.online/uploaded/image.jpg',\r\n          drawState: false,\r\n          deleteState: false,\r\n          modal:false,\r\n          undoStack: [], // Array to store rectangles for undo\r\n          redoStack: [], // Array to store rectangles for redo\r\n          item:{},\r\n          vdata:{}\r\n        };\r\n    },\r\n    methods: {\r\n      async submitForm(){\r\n        let that=this\r\n        const docRef = firebase.doc(firebase.firestore, 'ocr-layouts', this.$route.query.id);\r\n        this.rectangles[this.rectangles.length-1]['field']=this.vdata.field\r\n        firebase.updateDoc(docRef, {boxes:this.rectangles})\r\n        .then(() => {\r\n          that.modal=false\r\n          that.vdata={}\r\n        })\r\n        .catch((error) => {\r\n          console.error('Error updating document:', error);\r\n        });\r\n      },\r\n      cropimage(){\r\n        let that=this\r\n       const sourceImage = document.getElementById('original');\r\n            const x = 50; // Replace with your desired x-coordinate\r\n            const y = 50; // Replace with your desired y-coordinate\r\n            const width = 100; // Replace with your desired width\r\n            const height = 100; // Replace with your desired height\r\n\r\n            const canvas = document.createElement('canvas');\r\n            const ctx = canvas.getContext('2d');\r\n\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n\r\n            // Draw the cropped image onto the canvas\r\n            ctx.drawImage(sourceImage, -x, -y);\r\n\r\n            // Get the data URL of the cropped image\r\n            const dataURL = canvas.toDataURL();\r\n\r\n            // Save the data URL to a list or do whatever you need with it\r\n            const croppedImageList = [dataURL];\r\n\r\n            console.log('Cropped Image List:', croppedImageList);\r\n\r\n      },\r\n      saveBox(){\r\n        const docRef = firebase.doc(firebase.firestore, 'ocr-layouts', this.$route.query.id);\r\n        firebase.updateDoc(docRef, {boxes:this.rectangles})\r\n        .then(() => {\r\n        })\r\n        .catch((error) => {\r\n          console.error('Error updating document:', error);\r\n        });\r\n      },\r\n       async getData(){\r\n          let that=this;\r\n          const docRef = firebase.doc(firebase.firestore, 'ocr-layouts', that.$route.query.id);\r\n          firebase.getDoc(docRef)\r\n            .then((docSnapshot) => {\r\n              if (docSnapshot.exists()) {\r\n                let obj=docSnapshot.data();\r\n                that.item=obj;\r\n                if(obj.boxes){\r\n                  that.rectangles=obj.boxes\r\n                }\r\n                that.imageUrl=`https://hit-ocr.online/uploaded/`+obj.filename\r\n                console.log('Document data:', docSnapshot.data());\r\n              } else {\r\n                console.log('Document does not exist');\r\n              }\r\n            })\r\n            .catch((error) => {\r\n              console.error('Error getting document:', error);\r\n            });\r\n      },\r\n        resizeBoxes(){\r\n            function scaleBoxes(boxes, sourceWidth, sourceHeight, targetWidth, targetHeight) {\r\n                const scaleX = targetWidth / sourceWidth;\r\n                const scaleY = targetHeight / sourceHeight;\r\n\r\n                const scaledBoxes = boxes.map((box) => ({\r\n                    x: Math.round(box.x * scaleX),\r\n                    y: Math.round(box.y * scaleY),\r\n                    width: Math.round(box.width * scaleX),\r\n                    height: Math.round(box.height * scaleY),\r\n                }));\r\n\r\n                return scaledBoxes;\r\n                }\r\n\r\n                // Example usage\r\n                const boxes = this.rectangles\r\n\r\n                const sourceWidth = that.item.width;\r\n                const sourceHeight = that.item.height;\r\n                const targetWidth = 393;\r\n                const targetHeight = 644;\r\n\r\n                const scaledBoxes = scaleBoxes(boxes, sourceWidth, sourceHeight, targetWidth, targetHeight);\r\n                // this.resizeBox=scaledBoxes\r\n        },\r\n      mousedown(e) {\r\n        if (!this.deleteState && this.drawState) {\r\n          this.drawing = true;\r\n          const { offsetX, offsetY } = e;\r\n          this.start = { x: offsetX, y: offsetY };\r\n          this.rectangles.push({ ...this.start, width: 0, height: 0 });\r\n        }\r\n      },\r\n      mousemove(e) {\r\n        if (!this.deleteState && this.drawState && this.drawing) {\r\n          const { offsetX, offsetY } = e;\r\n          const { x, y } = this.start;\r\n          const rectangle = this.rectangles[this.rectangles.length - 1];\r\n          rectangle.width = offsetX - x;\r\n          rectangle.height = offsetY - y;\r\n          this.saveToLocalStorage();\r\n        }\r\n      },\r\n      mouseup() {\r\n        if(this.drawing){\r\n          console.log('cek',this.rectangles[this.rectangles.length-1])\r\n          if(this.rectangles[this.rectangles.length-1]['width']!=0 && this.rectangles[this.rectangles.length-1]['height']!=0){\r\n            this.modal=true;\r\n          }\r\n        }\r\n        this.rectangles=this.rectangles.filter(e=>e.width!=0 && e.height!=0)\r\n        if (this.drawState) {\r\n          this.drawing = false;\r\n        }\r\n      },\r\n      deleteRectangle(index) {\r\n        if (!this.deleteState) return;\r\n        this.rectangles.splice(index, 1);\r\n        this.saveToLocalStorage();\r\n        this.saveBox()\r\n      },\r\n      getRectangleStyles({ x, y, width, height }) {\r\n        return {\r\n          position: 'absolute',\r\n          left: `${x}px`,\r\n          top: `${y}px`,\r\n          width: `${width}px`,\r\n          height: `${height}px`,\r\n          border: '1px solid red',\r\n        };\r\n      },\r\n    // New method to undo the last drawing action\r\n    undo() {\r\n      if (this.rectangles.length > 0) {\r\n        this.redoStack.push(this.rectangles.pop());\r\n        this.saveToLocalStorage();\r\n        this.saveBox()\r\n      }\r\n    },\r\n\r\n    // New method to redo the previously undone drawing action\r\n    redo() {\r\n      if (this.redoStack.length > 0) {\r\n        this.rectangles.push(this.redoStack.pop());\r\n        this.saveToLocalStorage();\r\n        this.saveBox()\r\n      }\r\n    },\r\n      toggleDraw() {\r\n        this.drawState = !this.drawState;\r\n        this.deleteState = false;\r\n      },\r\n      toggleDelete() {\r\n        this.deleteState = !this.deleteState;\r\n        this.drawState = false;\r\n      },\r\n      saveToLocalStorage() {\r\n        // localStorage.setItem(\"rectangles\", JSON.stringify(this.rectangles));\r\n      }\r\n    },\r\n    mounted() {\r\n      this.getData()\r\n        document.addEventListener(\"keydown\",(event)=>{\r\n            if (event.ctrlKey && event.key === 'z') {\r\n                this.undo();\r\n            } else if (event.ctrlKey && event.key === 'y') {\r\n                this.redo();\r\n            }\r\n        })\r\n    },\r\n    created() {\r\n      if (localStorage.getItem(\"rectangles\")) {\r\n        this.rectangles = JSON.parse(localStorage.getItem(\"rectangles\"));\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style scoped>\r\n.rectangle {\r\n  background-color: rgba(255, 0, 0, 0.5);\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./draw.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./draw.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./draw.vue?vue&type=template&id=6d262464&scoped=true&\"\nimport script from \"./draw.vue?vue&type=script&lang=js&\"\nexport * from \"./draw.vue?vue&type=script&lang=js&\"\nimport style0 from \"./draw.vue?vue&type=style&index=0&id=6d262464&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6d262464\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","modal","staticStyle","_e","attrs","on","$event","_v","preventDefault","submitForm","apply","arguments","directives","name","rawName","value","vdata","expression","domProps","target","composing","$set","toggleDraw","toggleDelete","saveBox","drawState","deleteState","ref","mousedown","mousemove","mouseup","imageUrl","_l","rectangles","rect","index","key","style","getRectangleStyles","stopPropagation","deleteRectangle","_s","item","table","field","height","width","x","y","staticRenderFns","data","resizeBox","drawing","start","undoStack","redoStack","methods","that","docRef","firebase","doc","firestore","$route","query","id","length","updateDoc","boxes","then","catch","error","console","cropimage","sourceImage","document","getElementById","canvas","createElement","ctx","getContext","drawImage","dataURL","toDataURL","croppedImageList","log","getDoc","docSnapshot","exists","obj","filename","resizeBoxes","scaleBoxes","sourceWidth","sourceHeight","targetWidth","targetHeight","scaleX","scaleY","scaledBoxes","map","box","Math","round","e","offsetX","offsetY","push","rectangle","saveToLocalStorage","filter","splice","position","left","top","border","undo","pop","redo","mounted","getData","addEventListener","event","ctrlKey","created","localStorage","getItem","JSON","parse","component"],"sourceRoot":""}